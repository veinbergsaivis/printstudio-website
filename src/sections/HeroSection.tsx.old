import React, { useEffect, useState } from 'react';
import { useTranslation } from 'react-i18next';
import Button from '../components/Button'; // Pārbaudi ceļu!
import { cn } from '../lib/utils'; // Pārbaudi ceļu!

const HeroSection: React.FC = () => {
  const { t } = useTranslation();
  const [startAnimation, setStartAnimation] = useState(false);

  useEffect(() => {
    const timer = setTimeout(() => {
      setStartAnimation(true);
    }, 100);
    return () => clearTimeout(timer);
  }, []);

  const handleCTAClick = (targetId: string) => {
    const section = document.getElementById(targetId);
    if (section) {
      section.scrollIntoView({ behavior: 'smooth' });
    } else {
      console.warn(`Element with id '${targetId}' not found.`);
    }
  };

  // Pieņemam, ka nākamā sekcija ir ar 'bg-background' vai 'bg-white'
  // Ja nākamā sekcija ir, piemēram, ar 'bg-surface' (kas ir balts), tad from-surface
  // Ja nākamā sekcija ir ar 'bg-background' (kas ir da-offwhite), tad from-background
  const nextSectionBgClass = 'from-background'; // Pielāgo šo, ja nākamās sekcijas fons ir cits

  return (
    <section
      id="home"
      // Noņemam min-h-screen, ja vēlamies, lai sekcija beidzas ar gradientu,
      // vai arī atstājam un gradients būs virs daļas no hero.
      // Labāk ir, ja hero ir pietiekami augsts, lai gradients iederētos.
      className="relative min-h-screen flex items-center justify-center overflow-hidden"
    >
      {/* FONA SLĀŅI BEZ z-index */}
      {/* 1. Pamatnes krāsa (pilna) */}
      <div className="absolute inset-0 bg-background"></div>
      {/* 2. Gradients virsū (maigāks) */}
      <div className="absolute inset-0 bg-gradient-to-br from-primary/50 via-secondary/40 to-background/80 opacity-65"></div>

      {/* ANIMĒTIE ELEMENTI AR -z-10 */}
      <div className="absolute inset-0 overflow-hidden -z-10">
        <div className="absolute -top-20 -left-20 w-80 h-80 bg-secondary/15 rounded-full blur-3xl animate-blob"></div>
        <div className="absolute top-1/3 -right-20 w-96 h-96 bg-primary/15 rounded-full blur-3xl animate-blob animation-delay-2000"></div>
        <div className="absolute -bottom-20 left-1/3 w-72 h-72 bg-secondary/20 rounded-full blur-3xl animate-blob animation-delay-4000"></div>
      </div>

      {/* SATURA KONTEINERS AR z-10 */}
      <div className="container mx-auto px-4 z-10 text-center py-16">
        {/* Galvenais virsraksts */}
        <h1
          className={cn(
            "text-4xl md:text-5xl lg:text-7xl font-bold leading-tight mb-6",
            "text-text-base",
            "opacity-0 translate-y-5",
            startAnimation && "opacity-100 translate-y-0",
            "transition-all duration-700 ease-out"
          )}
        >
          <span className="block">{t('hero.headline.line1', 'Think Bigger.')}</span>
          <span className="block bg-gradient-to-r from-primary via-secondary to-primary text-transparent bg-clip-text">
            {t('hero.headline.line2', 'Print Bolder.')}
          </span>
        </h1>

        {/* Apraksts */}
        <p
          className={cn(
            "text-lg md:text-xl max-w-2xl mx-auto mb-10",
            "text-text-muted",
            "opacity-0 translate-y-5",
            startAnimation && "opacity-100 translate-y-0",
            "transition-all duration-700 ease-out delay-200"
          )}
        >
          {t('hero.description', 'Drukas risinājumi, kas atstāj iespaidu. Kvalitāte. Ātrums. Radošums.')}
        </p>

        {/* CTA pogas */}
        <div
          className={cn(
            "flex flex-col sm:flex-row items-center justify-center gap-4",
            "opacity-0 translate-y-5",
            startAnimation && "opacity-100 translate-y-0",
            "transition-all duration-700 ease-out delay-[400ms]"
          )}
        >
          <Button
            variant="primary"
            size="lg"
            onClick={() => handleCTAClick('services')}
          >
            {t('hero.cta.services', 'Skatīt pakalpojumus')}
          </Button>
          <Button
            variant="outline"
            size="lg"
            onClick={() => handleCTAClick('contact')}
          >
            {t('hero.cta.quote', 'Iegūsti piedāvājumu')}
          </Button>
        </div>
      </div>

      {/* === JAUNAIS SAPLŪŠANAS GRADIENTS === */}
      {/* Šis slānis būs virs visiem fona slāņiem, bet zem satura (ja saturs ir ar z-10) */}
      {/* Ja vēlies, lai tas ir virs animētajiem elementiem, bet zem satura, tam vajag z-index starp 0 un 10, piem., z-5 */}
      <div
        className={cn(
          "absolute bottom-0 left-0 w-full h-32 md:h-48 lg:h-64", // Pielāgo augstumu
          // Gradients no nākamās sekcijas fona uz CAURSPĪDĪGU,
          // lai parādītu hero sekcijas fonu zem tā.
          `bg-gradient-to-t ${nextSectionBgClass} to-transparent`,
          "pointer-events-none z-5" // z-index, lai ir virs fona animācijām, bet zem satura
        )}
      ></div>
    </section>
  );
};

export default HeroSection;